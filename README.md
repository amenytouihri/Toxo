# **RNA SEQUENCING**

## **Table of contents**

**Background**
- Description of the project
- List of Sample 

**Workflow**

- Setting up the environment
- Quality Control of the reads 
- Map reads to the reference genome 
- Count the number of reads 
- Analysis of differential expression 

## The Project Background
### Description 

This project analyzes _Toxoplasma gondii_ infection. This analysis examines how gene expression varies between mouse blood and lung tissues, aiming to identify the differently expressed genes and their associated GO terms.

This analysis is based on the dataset from and is available in the Gene Expression Omnibus (GEO), accession GSE119855. The dataset includes 3 biological replicates for the control samples and 5 replicates for Toxoplasma-infected mice in both lung and blood tissues.

### **List of Sample**

The "Sample" column corresponds to the names of the FASTQ files.

|   Sample   |     Group     |
|:----------:|:-------------:|
| SRR7821921 |   Lung Case   |
| SRR7821922 |   Lung Case   |
| SRR7821918 |   Lung Case   |
| SRR7821919 |   Lung Case   |
| SRR7821920 |   Lung Case   |
| SRR7821937 |  Lung Control |
| SRR7821938 |  Lung Control |
| SRR7821939 |  Lung Control |
| SRR7821949 |   Blood Case  |
| SRR7821950 |   Blood Case  |
| SRR7821951 |   Blood Case  |
| SRR7821952 |   Blood Case  |
| SRR7821953 |   Blood Case  |
| SRR7821968 | Blood Control |
| SRR7821969 | Blood Control |
| SRR7821970 | Blood Control |

## Workflow 
### 1. Setting up the environment 
A script called `0A_getsamplelist` is designed to organize and generate a file containing a list of samples essential for the rest of the workflow. The script creates a FASTQ directory that establishes links to all FASTQ files. Additionally, it generates a metadata folder that includes a sample_list file. This file provides the names of each sample along with the corresponding paths to Mate 1 and Mate 2 FASTQ files. Furthermore, it creates a file that retrieves the information from the README table, listing the names of all samples and their associated groups.
### 2. Quality Control of the reads 

* 1A_FASTQC : Run FastQC to assess the quality of the data
* 1B_MULTIQC : Generate MultiQC report for the quality control.  

### 3. Map reads to the reference genome 

* 2A_get_reference : Download reference genome (Mus_musculus.GRCm39.dna.primary_assembly.fa) and annotation (Mus_musculus.GRCm39.113.gtf) from Ensembl and perform a checksum verification step was performed to confirm that no corruption occurred during the download process.
* 2B_hisat_index : Generate indexes of the reference genome using the tools hisat
* 2C_hisat_mapping : Maps the reads to the reference genome using hisat
* 2E_samtools_conversion_bam: Convert the sam files generated during the last step to a bam file  by include the header in the output file then convert the output file to the BAM format then inform that the input file is in SAM format
* 2F_samtools_sort : Sort the BAM files
* 2G_samtools_index : Index the BAM files
* 2H_samtools_flagstat : Generate supplementary alignment statistics from the BAM files

### 4. Count the number of reads 

The script 3_featurecount uses FeatureCounts to generate a table of counts containing the number of reads per gene in each sample and a summary file.

### 5. Analysis of differential expression 

The file containing the names of all samples and their corresponding group generated in earlier steps and the table of counts generated by FeatureCounts are used  for the following R scripts:
* 4A_DE_utils.R : Sets the general constant, imports the  library utilized in the other R scripts, and will be loaded by all the other R scripts used for the Differential expression analysis.
* 4B_DE_preprocessing.R : Processes the count table data, prepares the sample metadata, performs the Differential expression analysis using DEseq2 and saves the result as an RDS file.
* 4C_DE_PCA.R : Performs a Principal component analysis on the result of the Differential expression analysis and generates the corresponding graph.
* 4D_DE_pairwise_comparaison.R : Performs pairwise differential expression analyses and Gene Ontology enrichment analysis, generates visualizations  and saves the results in Excel files and barplots as PNG files for further interpretation.

